---
layout: single
title:  "[CHAP5] 네트워크 및 콘텐츠 전송 서비스 - 4"
categories: AWS
---

# 04. VPC에서 VPC, 외부 서비스, 온프레미스와의 연결

## * VPC와 외부 네트워크 연결

다른 VPC나 VPC외 다른 AWS 서비스와 연결하는 기능이 있음  
**VPC 피어링**을 사용해 서로 다른 두 개의 VPC를 연결해 통신할 수 있음  
피어링은 두 개의 VPC간에 수행되기 때문에 세 개의 VPC가 서로 통신하는 경우 각 VPC끼리 따로 피어링을 구성해야 함  
연결된 VPC의 CIDR 블록은 겹치면 안 되므로 주의해야 함  
**AWS Transit Gateway (Transit Gateway)**를 사용하면 VPC 연결을 하나의 중앙 허브에서 관리할 수 있음  
VPN과 같이 온프레이미스 환경과의 연결에도 사용할 수 있으므로 **AWS 네트워크 연결을 중앙에서 관리** 할 수 있음  
요금은 VPC 피어링을 사용하는 것보다 높으므로 주의해야 하지만 많은 VPC를 사용해야 한다면 Transit Gateway를 사용해 중앙 관리를 하는 것이 좋음  


## * VPC와 VPC외 AWS 서비스를 연결

S3등 VPC 외부에서 동작하는 AWS 서비스는 보통 인터넷을 거쳐 통신하지만 **VPC 엔드포인트**를 이용하면 프라이빗 네트워크로 통신하게 할 수 있음  
VPC 엔트포인트를 설정한 VPC는 VPC 엔드포인트를 통해 S3와 같은 다른 AWS 서비스에 직접 접근할 수 있음  
S3나 DynamoDB에서 사용하는 VPC 엔드포인트를 **게이트웨이 엔드포인트**라고 하며 AWS 서비스와의 통신은 퍼블릭 IP를 이용함  
VPC 엔트포인트 외에 **인터페이스 엔드포인트**가 있음, 인터페이스 엔드포인트는 **AWS PrivateLink**라는 기능을 사용해 서브넷에 서비스 접속용 ENI(네트워크 인터페이스)를 생성해 프라이빗 IP로 통신함  
게이트웨이 엔드포인트는 S3 및 DynamoDB만을 지원하지만 인터페이스 엔드포인트는 많은 AWS 서비스를 지원함  
여기서 소개한 2개의 엔드포인트는 모두 VPC 외부의 AWS 서비스와 프라이빗(AWS 내) 통신을 하기 위한 기능  


## * VPC와 온프레미스 네트워크 연결

VPC는 AWS의 네트워크 및 서비스뿐만 아니라 온프레미스 네트워크와도 연결할 수 있음  
먼저 **AWS Site-to-Site VPN(Site-to-Site VPN)**은 온프레미스 환경의 네트워크와 VPC를 VPN으로 연결하는 기능임  
VPN은 **Virtual Private Network**의 약자로 가상으로 프라이빗 네트워크를 구성해 통신하는 기술, VPN에 접속하면 외부 네트워크와 프라이빗 IP주소로 통신할 수 있음  
온프레미스 환경에 있는 라우터 기기에 AWS 접속을 위한 설정을 하고 AWS에도 접속 설정을 하면 프라이빗 접속이 이루어짐  
프라이빗이라고 하지만 인터넷을 통해 통신이 이루어짐, IPsec VPN 이라는 기술을 사용해 인터넷에 가상으로 전용 네트워크를 만드는 형태임  
온프레미스 환경의 클라이언트 단말(PC)과 VPN을 연결하는 **AWS Client VPN(Client VPN)**이라는 기능도 있음  
온프레미스 환경 전체가 아니라 특정 단말과 비공개로 연결하고 싶은 경우 이 서비스를 추천  
그 밖에 AWS와 온프레미스 환경을 **전용선** 으로 연결하는 기능으로 **AWS Direct Connect(Direct Connect)** 가 있음  
VPC 외에 AWS 서비스와도 전용선 연결이 가능, AWS의 데이터 센터와 직접 연결하는 것이 아니라 Direct Connect 로케이션이라는 기존 연결 지점을 통해 연결함  


> 참고 : 그림과 작동 원리로 쉽게 이해하는 AWS 구조와 서비스