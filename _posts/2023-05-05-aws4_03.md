---
layout: single
title:  "[CHAP4] 스토리지 서비스 - 3"
categories: AWS
---

# 03. S3 데이터를 적절하게 저장

## * 사용하지 않는 객체는 저렴하게 저장

S3는 비용(요금)과 가용성이 다른 여러 **스토리지 클래스** 를 제공  
비용 효율성을 중시한 아카이브용 스토리지인 **Amazon S3Glacier**라는 스토리지 클래스도 있음  

|스토리지 클래스|특징|저장 AZ|가용성|
|---|---|---|---|
|S3 Standard(표준)|기본 스토리지 클래스|3개 이상|99.99%|
|S3 Inteligent-Tiering|접근 빈도에 따라 4개의 접근 계층으로 자동으로 나눠 비용 절감|3개 이상|99.90%|
|S3 Standard-IA|표준보다 저렴하지만 데이터 검색 용량에 대한 요금 부과|3개 이상|99.90%|
|S3 One Zone-IA|1AZ에만 데이터를 저장, 데이터 검색에 요금 발생|1개|99.50%|
|S3 Glacier Instant Retrieval|보존은 One Zone-IA보다 저렴하지만 꺼내는 비용이 많이 듦|3개 이상|99.99%|
|S3 Glacier Flexible Retrieval|보존은 S3 Glacier Instant Retrieval보다 저렴하지만 꺼내는 비용이 발생하고 시간이 걸림|3개 이상|99.99%|
|S3 Glacier Deep Archive|S3 Glacier보다도 저렴하지만 꺼내는 데 많은 시간(반나절 이상)이 걸림|3개 이상|99.99%|

스토리지 요금은 표준이 제일 높고 표 아래로 갈수록 저렴함  
거의 사용하지는 않지만 만약을 위해 보존하고 싶은 데이터가 있다면 S3 Glacier Deep Archive와 같은 저렴한 스토리지 클래스를 선택하는 것이 좋음  
반대로 웹 페이지에서 표시되는 콘텐츠와 같이 언제든지 사용할 수 있어야 하는 데이터를 저장하려면 표준(STANDARD)을 선택  
사용 빈도, 요구되는 가용성 및 비용 요구 사항에 따라 최적의 스토리지 클래스를 선택해야 함  
S3에는 **수명 주기 설정** 이라는 기능이 있어 자동으로 스토리지 클래스 변경도 가능함  
스토리지 클래스의 종류가 많아 어느 것을 사용하면 좋을지 모르겠다면 **S3용 액세스 분석기(S3 분석)** 라는 기능으로 얼마나 접근이 있었는지 등 데이터의 접근 상황을 확인해 참고하면 됨  


## * 버전 관리 및 다른 리전으로 복사

S3상의 데이터는 3곳 이상으로 복사되므로 WAS로 인해 데이터가 손실되는 경우는 거의 없음(서울 리전 전체 장애 등을 고려한다면 백업 필요)  
하지만 사용자의 실수로 데이터를 삭제하거나 의도하지 않은 데이터 변경 가능성이 있음, S3에는 버전 관리 기능이 있어 이 기능을 활성화해 데이터를 복구할 수 있음  
S3의 **버전 관리 기능**을 활성화 하면 모든 세대의 객체에 대한 이력 정보가 보존됨
객체 **갱신 시(PUT)** 에는 기존 객체와 다른 새로운 버전 ID가 부여됨, 버전 관리 설정은 S3 버킷 단위로 할 수 있고 객체 단위의 설정은 불가능함  
**삭제 조작(DELETE)** 을 했을 경우 객체가 실제로 삭제되는 것이 아니라 **삭제 마커**가 부여됨, 해당 객체의 과거 버전은 유지됨  
삭제 마커가 부여된 객체에 GET요청을 보내면 404 Not Found 오류가 반환됨, 버전ID를 지정해 삭제하면 지정한 버전을 삭제할 수 있음  
S3의 버전 관리는 사용자의 잘못된 조작으로 인한 파일 삭제나 변경을 복구할 수 있는 편리한 기능이지만, 각 버전은 별개의 객체로 보존되기 때문에 추가 요금이 발생함  
데이터 저장 위치와 다른 리전에 복사하는 기능을 **교차 리전 복제(CRR-Cross Region Replication)** 라고 함  


> 참고 : 그림과 작동 원리로 쉽게 이해하는 AWS 구조와 서비스