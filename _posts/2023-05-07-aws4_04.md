---
layout: single
title:  "[CHAP4] 스토리지 서비스 - 4"
categories: AWS
---

# 04. S3 데이터를 안전하게 공개

## * S3 버킷에 대한 접근 제어

S3 버킷에는 개인 정보와 같은 중요한 정보도 저장될 수 있으므로 허가받은 사람이 허가받은 객체에 올바르게 접근할 수 있도록 **접근 제어**를 하는 것이 중요함  

접근 제어 방법
1. 사용자 정책 (IAM정책)
  - 데이터를 **조작하는 쪽을 제어**하는 설정
  - 'A는 S3버킷의 데이터 검색만 가능하고 업로드는 불가' 라는 식으로 **사용자에 대한 권한을 설정**할 수 있음

2. 접근 제어 목록 (ACL)
  - **객체(데이터) 또는 버킷 단위로 설정**할 수 있는 접근 제어
  - '데이터는 A는 AWS 계정 X에 접근 허용', '데이터 B는 모든 사용자에게 접근 허용' 과 같이 **데이터별로 상세한 설정**을 할 수 있음

3. 버킷 설정
  - **버킷 단위로 설정**하는 접근 제어
  - 버킷 단위라고 해도 '파일 이름이 logs로 시작하는 데이터에 접근 허용', 'IP주소 ~~~ 로 부터 접근 허가' 와 같이 복잡한 설정을 할 수 있음, 설정은 **JSON 형식으로 기재**

버킷 정책이나 ACL 설정 내용에 따라 객체를 전 세계에 공개하는 **퍼블릭 상태**가 되므로 주의가 필요(의도적으로 공개하는 것이 아니라면 외부 공개가 되지 않게 해야 함)  
S3에는 **퍼블릭 액세스 차단** 이라는 기능이 있어 의도치 않게 S3 버킷이나 객체가 공개 상태가 되는 것을 방지할 수 있음  


## * S3를 이용해 웹 사이트 구축

S3 버킷에 저장된 HTML, CSS, 자바스크립트 등 콘텐츠 파일을 이용해 웹 사이트를 구축할 수 있음  
S3의 **웹 사이트 호스팅 기능**을 활성화하면 **http://버킷이름.s3-website-리전이름.amazon.com** 이라는 URL이 만들어지고, 브라우저에서 접속할 수 있음  
특정 사용자만 콘텐츠에 접근하게 제어할 수도 있음  
S3는 암호화된 통신인 HTTPS를 지원하지 않으므로 민감한 정보가 포함된 사이트를 운영해야 하는 경우 **콘텐츠 전송 네트워크(CDN)** 서비스인  
**Amazon CloudFront**를 함께 사용해 HTTPS통신을 할 수 있게 구성함  


## * 데이터 암호화

**데이터 암호화**를 실시하면 **데이터**와 **키 데이터**를 조합해 데이터 내용을 타인이 볼 수 없게 함  
데이터가 없으면 데이터를 읽을 수 없게 되고 키 데이터가 유출되면 타인이 데이터를 읽을 수 있게 되므로 **키 데이터**를 안전하게 관리해 데이터를 보호해야 함  
S3에서는 버킷의 기본 암호화 기능을 활성화하면 객체를 저장할 때 AWS에서 자동으로 암호화를 수행함  
암호화용 키는 AWS에서 제공하는 키 관리 기능인 **AWS Key Management Service(KMS)**에서 생성한 키와 사용자가 관리하는 키가 있음  
KMS 키를 사용하면 AWS시스템 내에서 자동으로 암호화 처리를 수행하므로 사용자는 객체를 저장하기만 하면 됨  
암호화는 S3 관리 콘솔에서 간단하게 설정할 수 있음, 사용자가 관리하는 키(SSE-C)를 이용하는 경우 사전에 키를 준비해야 함  
S3에서 제공되는 기능은 객체 저장 시 암호화이므로 S3로 전송할 대 암호화하고 싶다면 미리 데이터를 응용 프로그램에서 암호화해 전송해야 하는데  
이를 **클라이언트 측 암호화** 라고 함  
클라이언트 측 암호화에는 사용자 고유의 키나 KMS 키를 사용할 수 있음  
S3의 API에 대한 접근은 기본적으로 HTTPS에서 수행되므로 통신은 모두 암호화됨  


> 참고 : 그림과 작동 원리로 쉽게 이해하는 AWS 구조와 서비스