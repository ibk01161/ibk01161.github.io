---
layout: single
title:  "[CHAP5] 네트워크 및 콘텐츠 전송 서비스 - 6"
categories: AWS
---

# 06. ELB로 부하를 분산시켜 가용성 향상

## * ELB란

**Elastic Load Balancing(ELB)**은 AWS에서 제공하는 로드 밸런서 서비스, 로드 밸런서의 주요 기능은 응용 프로그램으로 트래픽(네트워크를 통해 흐르는 데이터)을 로드 밸런싱하는 것  
또한 트래픽을 보내는 서버(EC2와 같은 인스턴스)가 멈추지 않고 실행 중인지 정기적으로 확인해 가용성을 확인할 수 있음  

* ELB가 제공하는 기본 기능

1. 부하 분산
트래픽을 여러 대상으로 전달하도록 지정하면 사용자의 접속을 자동으로 분산할 수 있음, 이렇게 설정하면 대량 접속이 발생하더라도 **부하를 나눌 수 있음**  
또한 각 대상을 다른 AZ에 배치할 수 있으므로 지리적으로 분산할 수 있어 재해가 발생했을 때의 **가용성도 향상**시킬 수 있음  
ELB 자체는 부하 상황에 따라 **자동으로 스케일**되므로 사용자는 ELB 성능 저하를 신경 쓸 필요가 없음  

2. 대상 모니터링
ELB는 항상 대상(트래픽의 도착지)에 대한 **연결과 상태를 감시하고 확인**함  
이를 통해 **요청추적**이나 **CloudWatch 지표**를 취득할 수 있으므로 언제든지 이를 확인할 수 있음, 감시를 통해 비정상적인 동작을 감지하면 대상을 자동으로 분리해 안정적인 작동을 유지할 수 있음  

3. 보안 기능
ELB는 보안 그룹을 비롯한 AWS의 기본적인 **보안 서비스**를 적용할 수 있고 **SSL/TLS 서버 인증서를 설정해 암호화 통신**을 수행할 수 있음  
NLB(Network Load Balancer)는 보안 그룹을 설정할 수 없음  


## * ELB 유형

|이름|설명|
|---|---|
|Application Load Balancer(ALB)|HTTP 트래픽과 HTTPS 트래픽의 부하 분산이 가능 <br> 레이어7(응용프로그램 계층)로 동작하므로 마이크로 서비스나 컨테이너 등 다양한 응용 프로그램에도 대응 가능|
|Network Load Balancer(NLB)|레이어4(전송 계층)에서 동작하므로 HTTP/HTTPS 외 TCP, UDP, TLS 트래픽의 부하 분산도 가능 <br> 트래픽의 부하 분산도 가능 <br> 수백만 건 이상 요청이 발생하는 대규모 트래픽에서도 속도가 빠름|
|Classic Load Balancer(CLB)|ALB, NLB 서비스 이전부터 제공된 구형 로드 밸런서 <br> 레이어4(전송 계층) 및 레이어7(응용 프로그램)에서 동작 <br> 예전 아키텍처를 이용해야 하는 등 특별한 경우를 제외하고는 기본적으로 ALB나 NLB의 이용을 권장|
|Gateway Load Balancer(GWLB)|AWS에서 제공하는 타사 보안 제품의 배포 및 관리 가능 <br> 레이어3(네트워크 계층)에서 동작 <br> 기존 NLB 및 VPC 피어링, Transit Gateway에서 구현하던 아키텍처를 더욱 단순하게 구현 가능|

기본적으로 요건에 따라 **ALB** 또는 **NLB** 중 하나를 선택해야 함  
일반적으로 웹 사이트나 웹 시스템의 부하 분산에는 **ALB**, ALB로 구현할 수 없는 미세한 제어나 HTTP/HTTPS. 이외의 프로토콜을 이용하는 경우는 **NLB**를 선택


## * ELB 요금 예

ELB 이용료는 1시간당 로드 밸런서 사용료(고정)와 로드 밸런서 커패서티 유닛(Load balancer Capacity Unit-LCU) 이용료(변동)를 합산해 계산  
LCU는 초당 새 연결 수, 활성 연결 수, 처리된 바이트, 규칙 평가를 측정하며 그중 가장 사용량이 많은 것에 대해서만 요금이 부과됨  
대규모 시스템을 운영하거나 처리하는 데이터가 많다면 LCU 비용도 고려해야 함  


> 참고 : 그림과 작동 원리로 쉽게 이해하는 AWS 구조와 서비스